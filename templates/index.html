<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduTube Navigator - YOUTUBE í•™ìŠµ íë ˆì´í„°</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- ìµœìƒë‹¨ ê²€ì€ ë  ë°°ë„ˆ -->
    <div class="top-banner">
        ğŸ”¥ í•œêµ­ ìµœê·¼ í•œë‹¬ ì¸ê¸° êµìœ¡ ì˜ìƒ íë ˆì´ì…˜ AIê°€ ì—„ì„ í•œ ê³ í’ˆì§ˆ í•™ìŠµ ì½˜í…ì¸ ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”
    </div>
    
    <div class="main-container">
        <!-- ë¡œê³  -->
        <h1 class="logo">EduTube</h1>
        
        <!-- ê²€ìƒ‰ ì˜ì—­ -->
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" id="searchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
        </div>
        
        <!-- ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ë“¤ -->
        <div class="category-row">
            <button class="category-btn active" data-category="language">Language</button>
            <button class="category-btn" data-category="programming">Programming</button>
            <button class="category-btn" data-category="hobby">Hobby</button>
            <button class="category-btn" data-category="certificate">Certificate</button>
            <button class="category-btn" data-category="etc">Etc</button>
        </div>
        
        <!-- í•˜ìœ„ ì¹´í…Œê³ ë¦¬ -->
        <div class="language-tabs subcategory-row">
            <button class="subcategory-btn active" data-subcategory="english">ì˜ì–´</button>
            <button class="subcategory-btn" data-subcategory="chinese">ì¤‘êµ­ì–´</button>
            <button class="subcategory-btn" data-subcategory="japanese">ì¼ë³¸ì–´</button>
        </div>
        
        <!-- ì˜ìƒ ì–¸ì–´ ì„ íƒ & ì½˜í…ì¸  íƒ€ì… ì„ íƒ & ì •ë ¬ ì˜µì…˜ -->
        <div class="filter-controls">
            <div class="filter-group dropdown" id="languageDropdown">
                <span class="filter-icon">â–¼</span>
                <span class="filter-label" id="languageLabel">í•œêµ­ì–´</span>
                <div class="dropdown-menu" id="languageMenu">
                    <div class="dropdown-item active" data-lang="ko">í•œêµ­ì–´</div>
                    <div class="dropdown-item" data-lang="en">ì˜ì–´</div>
                </div>
            </div>
            <div class="filter-group dropdown" id="contentTypeDropdown">
                <span class="filter-icon">â–¼</span>
                <span class="filter-label" id="contentTypeLabel">ë¹„ë””ì˜¤</span>
                <div class="dropdown-menu" id="contentTypeMenu">
                    <div class="dropdown-item active" data-type="video">ë¹„ë””ì˜¤</div>
                    <div class="dropdown-item" data-type="shorts">ì‡¼ì¸ </div>
                </div>
            </div>
            <div class="filter-group dropdown" id="sortOrderDropdown">
                <span class="filter-icon">â–¼</span>
                <span class="filter-label" id="sortOrderLabel">ì¸ê¸°ìˆœ</span>
                <div class="dropdown-menu" id="sortOrderMenu">
                    <div class="dropdown-item active" data-sort="viewCount">ğŸ”¥ ì¸ê¸°ìˆœ</div>
                    <div class="dropdown-item" data-sort="date">ğŸ†• ìµœì‹ ìˆœ</div>
                </div>
            </div>
        </div>
        
        <!-- ë¹„ë””ì˜¤ ë¦¬ìŠ¤íŠ¸ -->
        <div class="video-list" id="videoList">
            <!-- ë¹„ë””ì˜¤ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>
        <!-- ë¡œë”© ìŠ¤í”¼ë„ˆ -->
        <div class="loading-spinner" id="loadingSpinner" style="display:none;">
            <div class="spinner"></div>
        </div>
        <!-- ë¹ˆ ìƒíƒœ -->
        <div class="empty-state" id="emptyState" style="display:none;">
            <i class="fas fa-search"></i>
            <h3>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
            <p>ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”</p>
        </div>
        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div class="pagination" id="pagination">
            <button class="page-number active" data-page="1">1</button>
            <button class="page-number" data-page="2">2</button>
            <button class="page-number" data-page="3">3</button>
            <button class="page-number" data-page="4">4</button>
            <button class="page-number" data-page="5">5</button>
        </div>
    </div>
    <!-- ì‚¬ì´ë“œë°”/ì˜¤ë²„ë ˆì´ ë“±ì€ í•„ìš”ì‹œ ì¶”ê°€ -->
    <script>
        // ê¸°ì¡´ JS ì½”ë“œ ìœ ì§€ (ì¹´í…Œê³ ë¦¬, ê²€ìƒ‰, ê²°ê³¼ í‘œì‹œ ë“±)
        let currentCategory = 'language';
        let currentSubcategory = 'english';
        let currentPage = 1;
        let isLoading = false;
        let currentSortOrder = 'viewCount';
        let currentLang = 'ko';
        let currentContentType = 'video'; // ê¸°ë³¸ê°’: ë¹„ë””ì˜¤
        
        const categoryData = {
            language: ['ì˜ì–´', 'ì¤‘êµ­ì–´', 'ì¼ë³¸ì–´'],
            programming: ['Python', 'JavaScript', 'ì›¹ê°œë°œ', 'ë°ì´í„°ë¶„ì„'],
            hobby: ['ì·¨ë¯¸', 'ìš´ë™', 'ìš”ë¦¬', 'ì—¬í–‰'],
            certificate: ['í† ìµ', 'í† í”Œ', 'ì»´í™œ', 'ì •ë³´ì²˜ë¦¬ê¸°ì‚¬'],
            etc: ['ê¸°íƒ€', 'êµì–‘', 'ìƒì‹']
        };
        
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentCategory = this.dataset.category;
                updateSubcategories(currentCategory);
                performSearch();
            });
        });
        
        function updateSubcategories(category) {
            const items = categoryData[category] || [];
            const subRow = document.querySelector('.subcategory-row');
            subRow.innerHTML = '';
            items.forEach((item, idx) => {
                const btn = document.createElement('button');
                btn.className = 'subcategory-btn' + (idx === 0 ? ' active' : '');
                btn.dataset.subcategory = item.toLowerCase();
                btn.textContent = item;
                btn.onclick = function() {
                    document.querySelectorAll('.subcategory-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentSubcategory = this.dataset.subcategory;
                    performSearch();
                };
                subRow.appendChild(btn);
            });
            if (items.length > 0) currentSubcategory = items[0].toLowerCase();
        }
        
        function performSearch() {
            if (isLoading) return;
            isLoading = true;
            document.getElementById('videoList').innerHTML = '';
            document.getElementById('emptyState').style.display = 'none';
            const searchQuery = document.getElementById('searchInput').value.trim();
            
            const formData = new FormData();
            formData.append('query', searchQuery || '');
            formData.append('category', currentCategory);
            formData.append('subcategory', currentSubcategory);
            formData.append('page', currentPage);
            formData.append('sortOrder', currentSortOrder);
            formData.append('language', currentLang);
            formData.append('recent_month', 'true'); // ê¸°ë³¸ê°’: ìµœê·¼ í•œë‹¬
            formData.append('content_type', currentContentType);
            
            fetch('/search', { method: 'POST', body: formData })
            .then(response => response.json())
            .then(data => {
                if (data.success !== false && data.videos && data.videos.length > 0) {
                    displayResults(data.videos);
                } else {
                    showEmptyState();
                }
                isLoading = false;
            })
            .catch(error => {
                showEmptyState();
                isLoading = false;
            });
        }
        function displayResults(videos) {
            const videoList = document.getElementById('videoList');
            const emptyState = document.getElementById('emptyState');
            emptyState.style.display = 'none';
            videoList.innerHTML = '';
            videos.forEach(video => {
                const card = document.createElement('div');
                card.className = 'video-card';
                
                // ì½˜í…ì¸  íƒ€ì…ì— ë”°ë¥¸ ë±ƒì§€ ì¶”ê°€
                const contentBadge = currentContentType === 'shorts' 
                    ? '<span class="content-badge shorts">ğŸ¬ ì‡¼ì¸ </span>'
                    : '<span class="content-badge video">ğŸ“¹ ë¹„ë””ì˜¤</span>';
                
                card.innerHTML = `
                    <div class="video-thumbnail">
                        ${video.thumbnail ? `<img src="${video.thumbnail}" alt="${video.title}">` : `<div>thumbnail</div>`}
                        ${contentBadge}
                        ${video.isPopularChannel ? '<span class="popular-channel-badge">â­ ì¸ê¸° ìœ íŠœë²„</span>' : ''}
                    </div>
                    <div class="video-info">
                        <div class="video-title">${video.title}</div>
                        <div class="video-channel">${video.channelTitle}</div>
                        <div class="video-meta">
                            <span>â±ï¸ ${video.duration}</span>
                            <span>ğŸ‘€ ${video.viewCount?.toLocaleString() || 'ì •ë³´ ì—†ìŒ'}</span>
                        </div>
                        <div class="video-summary">${video.summary || video.description || 'This is Summary'}</div>
                    </div>
                `;
                videoList.appendChild(card);
            });
        }
        function showEmptyState() {
            document.getElementById('videoList').innerHTML = '';
            document.getElementById('emptyState').style.display = 'block';
        }
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                currentPage = 1;
                performSearch();
            }
        });
        document.querySelectorAll('.page-number').forEach(pageBtn => {
            pageBtn.addEventListener('click', function() {
                document.querySelectorAll('.page-number').forEach(p => p.classList.remove('active'));
                this.classList.add('active');
                currentPage = parseInt(this.dataset.page);
                performSearch();
            });
        });
        document.addEventListener('DOMContentLoaded', function() {
            updateSubcategories('language');
            currentCategory = 'language';
            currentSubcategory = 'english';
            currentSortOrder = 'viewCount';
            
            // ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
            setupDropdowns();
            
            performSearch();
        });
        
        // ë“œë¡­ë‹¤ìš´ ê¸°ëŠ¥
        function setupDropdowns() {
            // ì–¸ì–´ ë“œë¡­ë‹¤ìš´
            const languageDropdown = document.getElementById('languageDropdown');
            const languageMenu = document.getElementById('languageMenu');
            const languageLabel = document.getElementById('languageLabel');
            
            languageDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
                languageMenu.classList.toggle('show');
                // ë‹¤ë¥¸ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
                document.getElementById('contentTypeMenu').classList.remove('show');
                document.getElementById('sortOrderMenu').classList.remove('show');
            });
            
            languageMenu.addEventListener('click', function(e) {
                if (e.target.classList.contains('dropdown-item')) {
                    // ì´ì „ í™œì„± í•­ëª© ì œê±°
                    languageMenu.querySelector('.active').classList.remove('active');
                    // ìƒˆ í•­ëª© í™œì„±í™”
                    e.target.classList.add('active');
                    // ë¼ë²¨ ì—…ë°ì´íŠ¸
                    languageLabel.textContent = e.target.textContent;
                    // ì–¸ì–´ ë³€ê²½
                    currentLang = e.target.dataset.lang;
                    // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
                    languageMenu.classList.remove('show');
                    // ê²€ìƒ‰ ì‹¤í–‰
                    performSearch();
                }
            });
            
            // ì½˜í…ì¸  íƒ€ì… ë“œë¡­ë‹¤ìš´
            const contentTypeDropdown = document.getElementById('contentTypeDropdown');
            const contentTypeMenu = document.getElementById('contentTypeMenu');
            const contentTypeLabel = document.getElementById('contentTypeLabel');
            
            contentTypeDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
                contentTypeMenu.classList.toggle('show');
                // ë‹¤ë¥¸ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
                document.getElementById('languageMenu').classList.remove('show');
                document.getElementById('sortOrderMenu').classList.remove('show');
            });
            
            contentTypeMenu.addEventListener('click', function(e) {
                if (e.target.classList.contains('dropdown-item')) {
                    // ì´ì „ í™œì„± í•­ëª© ì œê±°
                    contentTypeMenu.querySelector('.active').classList.remove('active');
                    // ìƒˆ í•­ëª© í™œì„±í™”
                    e.target.classList.add('active');
                    // ë¼ë²¨ ì—…ë°ì´íŠ¸
                    contentTypeLabel.textContent = e.target.textContent;
                    // ì½˜í…ì¸  íƒ€ì… ë³€ê²½
                    currentContentType = e.target.dataset.type;
                    // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
                    contentTypeMenu.classList.remove('show');
                    // ê²€ìƒ‰ ì‹¤í–‰
                    performSearch();
                }
            });
            
            // ì •ë ¬ ì˜µì…˜ ë“œë¡­ë‹¤ìš´
            const sortOrderDropdown = document.getElementById('sortOrderDropdown');
            const sortOrderMenu = document.getElementById('sortOrderMenu');
            const sortOrderLabel = document.getElementById('sortOrderLabel');
            
            sortOrderDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
                sortOrderMenu.classList.toggle('show');
                // ë‹¤ë¥¸ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
                document.getElementById('languageMenu').classList.remove('show');
                document.getElementById('contentTypeMenu').classList.remove('show');
            });
            
            sortOrderMenu.addEventListener('click', function(e) {
                if (e.target.classList.contains('dropdown-item')) {
                    // ì´ì „ í™œì„± í•­ëª© ì œê±°
                    sortOrderMenu.querySelector('.active').classList.remove('active');
                    // ìƒˆ í•­ëª© í™œì„±í™”
                    e.target.classList.add('active');
                    // ë¼ë²¨ ì—…ë°ì´íŠ¸
                    sortOrderLabel.textContent = e.target.textContent;
                    // ì •ë ¬ ì˜µì…˜ ë³€ê²½
                    currentSortOrder = e.target.dataset.sort;
                    // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
                    sortOrderMenu.classList.remove('show');
                    // ê²€ìƒ‰ ì‹¤í–‰
                    performSearch();
                }
            });
            
            // ì™¸ë¶€ í´ë¦­ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
            document.addEventListener('click', function() {
                languageMenu.classList.remove('show');
                contentTypeMenu.classList.remove('show');
                sortOrderMenu.classList.remove('show');
            });
        }
    </script>
</body>
</html> 
